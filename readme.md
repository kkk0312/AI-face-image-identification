__说明文档__

__前言__

__文档共分为两部分：第一部分讲解代码运行逻辑；第二部分为训练参数和策略。__

第一部分详细解释了代码的运行，输出CSV文件的位置，以及需要导入的库。

第二部分介绍了模型训练的参数和数据增强的策略。

<a id="_Toc31809"></a>__一、代码运行讲解__

__代码运行环境为：cuda版本12\.4，pytorch版本2\.4\.1\+cu124。__

首先必须要导入必要的库，所需库的版本等信息会在requirements\.txt文件中进行详细介绍。

torch==2\.4\.1\+cu124

torchvision==0\.19\.1\+cu124

PIL==10\.2\.0

timm==1\.0\.9

safetensors==safetensors

必须导入预训练模型convnext\_large,我们将模型文件存放在了src文件夹中，可以自动导入。

接着代码会__读取系统根目录下的testdata文件__，提取特征。

最后会从__src文件夹中加载__我们训练的分类器模型，然后进行分类，并__输出CSV文件到src文件夹__中。（根据我们的理解，\./cla\_pre\.csv的意思，其中\./的意思就是当前运行脚本的目录下，就是main\.py文件的同级目录下，也就是src目录下，所以我们将csv文件输出到src文件夹下，我们的理解是这样的。）

<a id="_Toc17931"></a>__二、训练参数和策略__

根据多次训练测试，选择的超参数为4层隐藏层，'hidden\_dims': \[2048, 1024, 512, 256\],'dropout\_rate': 0\.3,'learning\_rate': 0\.001,'l2\_lambda': 0\.001,'batch\_size': 128,'num\_epochs': 20。通过dropout和L2正则化来防止过拟合，使用二元交叉熵函数作为损失函数。并通过使用随机剪裁、高斯模糊\+jpeg压缩等数据增强技术处理训练数据。

